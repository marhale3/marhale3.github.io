---
layout: problem
difficulty: 60
title: "Pencils of rays"
problemId: 372
answer: -1
---

<p>
Let R(<var>M</var>, <var>N</var>) be the number of lattice points (<var>x</var>, <var>y</var>) which satisfy <var>M</var>&lt;<var>x</var>&le;<var>N</var>, <var>M</var>&lt;<var>y</var>&le;<var>N</var> and <img style="vertical-align:middle" src="{{ site.baseurl }}project/images/p372_pencilray1.jpg" /> is odd.<br />
We can verify that R(0, 100) = 3019 and R(100, 10000) = 29750422.<br />
Find R(2&middot;10<sup>6</sup>, 10<sup>9</sup>).
</p>

<p>
<u><i>Note</i></u>: <img style="vertical-align:middle" src="{{ site.baseurl }}project/images/p372_pencilray2.gif" /> represents the floor function.</p>
</p>
