---
layout: problem
title: 'Mixtures'
problemId: 478
answer: -1
---

<p>Let us consider <b>mixtures</b> of three substances: <b>A</b>, <b>B</b> and <b>C</b>. A mixture can be described by a ratio of the amounts of <b>A</b>, <b>B</b>, and <b>C</b> in it, i.e., (<var>a</var>&nbsp;:&nbsp;<var>b</var>&nbsp;:&nbsp;<var>c</var>). For example, a mixture described by the ratio (2&nbsp;:&nbsp;3&nbsp;:&nbsp;5) contains 20% <b>A</b>, 30% <b>B</b> and 50% <b>C</b>.</p>

<p>For the purposes of this problem, we cannot separate the individual components from a mixture. However, we can combine different amounts of different mixtures to form mixtures with new ratios.</p>

<p>For example, say we have three mixtures with ratios (3&nbsp;:&nbsp;0&nbsp;:&nbsp;2), (3&nbsp;:&nbsp;6&nbsp;:&nbsp;11) and (3&nbsp;:&nbsp;3&nbsp;:&nbsp;4). By mixing 10 units of the first, 20 units of the second and 30 units of the third, we get a new mixture with ratio (6&nbsp;:&nbsp;5&nbsp;:&nbsp;9), since:<br/>
(10&middot;<sup>3</sup>/<sub>5</sub>&nbsp;+&nbsp;20&middot;<sup>3</sup>/<sub>20</sub>&nbsp;+&nbsp;30&middot;<sup>3</sup>/<sub>10</sub>&nbsp;:&nbsp;10&middot;<sup>0</sup>/<sub>5</sub>&nbsp;+&nbsp;20&middot;<sup>6</sup>/<sub>20</sub>&nbsp;+&nbsp;30&middot;<sup>3</sup>/<sub>10</sub>&nbsp;:&nbsp;10&middot;<sup>2</sup>/<sub>5</sub>&nbsp;+&nbsp;20&middot;<sup>11</sup>/<sub>20</sub>&nbsp;+&nbsp;30&middot;<sup>4</sup>/<sub>10</sub>)
= (18&nbsp;:&nbsp;15&nbsp;:&nbsp;27) = (6&nbsp;:&nbsp;5&nbsp;:&nbsp;9)</p>

<p>However, with the same three mixtures, it is impossible to form the ratio (3&nbsp;:&nbsp;2&nbsp;:&nbsp;1), since the amount of <b>B</b> is always less than the amount of <b>C</b>.</p>

<p>Let <var>n</var> be a positive integer. Suppose that for every triple of integers (<var>a</var>, <var>b</var>, <var>c</var>) with 0 &le; <var>a</var>, <var>b</var>, <var>c</var> &le; <var>n</var> and gcd(<var>a</var>, <var>b</var>, <var>c</var>) = 1, we have a mixture with ratio (<var>a</var>&nbsp;:&nbsp;<var>b</var>&nbsp;:&nbsp;<var>c</var>). Let M(<var>n</var>) be the set of all such mixtures.</p>

<p>For example, M(2) contains the 19 mixtures with the following ratios:<br/>
{(0&nbsp;:&nbsp;0&nbsp;:&nbsp;1), (0&nbsp;:&nbsp;1&nbsp;:&nbsp;0), (0&nbsp;:&nbsp;1&nbsp;:&nbsp;1), (0&nbsp;:&nbsp;1&nbsp;:&nbsp;2), (0&nbsp;:&nbsp;2&nbsp;:&nbsp;1), <br/>
(1&nbsp;:&nbsp;0&nbsp;:&nbsp;0), (1&nbsp;:&nbsp;0&nbsp;:&nbsp;1), (1&nbsp;:&nbsp;0&nbsp;:&nbsp;2), (1&nbsp;:&nbsp;1&nbsp;:&nbsp;0), (1&nbsp;:&nbsp;1&nbsp;:&nbsp;1), <br/>
(1&nbsp;:&nbsp;1&nbsp;:&nbsp;2), (1&nbsp;:&nbsp;2&nbsp;:&nbsp;0), (1&nbsp;:&nbsp;2&nbsp;:&nbsp;1), (1&nbsp;:&nbsp;2&nbsp;:&nbsp;2), (2&nbsp;:&nbsp;0&nbsp;:&nbsp;1), <br/>
(2&nbsp;:&nbsp;1&nbsp;:&nbsp;0), (2&nbsp;:&nbsp;1&nbsp;:&nbsp;1), (2&nbsp;:&nbsp;1&nbsp;:&nbsp;2), (2&nbsp;:&nbsp;2&nbsp;:&nbsp;1)}.</p>

<p>Let E(<var>n</var>) be the number of subsets of M(<var>n</var>) which can produce the mixture with ratio (1 : 1 : 1), i.e., the mixture with equal parts <b>A</b>, <b>B</b> and <b>C</b>. <br/>
We can verify that E(1) = 103, E(2) = 520447, E(10)&nbsp;mod&nbsp;11<sup>8</sup> = 82608406 and E(500)&nbsp;mod&nbsp;11<sup>8</sup> = 13801403.<br/>
Find E(10&nbsp;000&nbsp;000)&nbsp;mod&nbsp;11<sup>8</sup>.</p>

